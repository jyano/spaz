
X  = function(a){return $h(a,"Context2D")}



tX = gX =xX =_x = $X = clr  = _t =function(a,b,c){
    if(U(a)){return $b().empty()}
    if(N(a)){return _.times(a,b,c)}
    if(O(b)){return $a(_.extend, arguments)}

    if(X(a)){return a}
    if(E(a)||Q(a)){return $(a)[0].getContext('2d') }
    if(ok(arguments)){
        return a}}







X  = function(a){return $h(a,"Context2D")}
tX = gX =xX =_x = $X = clr  = _t =function(a,b,c){
    if(U(a)){return $b().empty()}
    if(N(a)){return _.times(a,b,c)}
    if(O(b)){return $a(_.extend, arguments)}

    if(X(a)){return a}
    if(E(a)||Q(a)){return $(a)[0].getContext('2d') }
    if(ok(arguments)){
        return a}}
$x=ox=function(c){

    if(F(c)){return c}

    var l=function l(a,b){
        var g=tA(arguments)
        if(A(a)){return l.p(a[0])}
        if(O(a)){l.p(a)
            if(!b){return l.x}
            return $a(l.m,_r(g))}
        if(O(a)){l.p(a)
            return l}
        return $a(l.m,g)||l}

    l.x=tX(c);
    l.c=x.canvas;
    l.q=$(l.c)
    l.m=xm(l.x)
    l.p=xp(l.x)
    l.w=l.c.width
    l.h=l.c.height
    return l}
xp=function l(a,b,c){if(U(b)){return _p(l,a)}
    if(O(b)){pop('X', tX(a),b);return l}
    if(S(b)) return pop('X', tX(a), b,c)}
xm=function(a,b,c){var x=met('x');a=tX(a)
    if(U(b)){return _p(x,a)}
    if(U(c)){return _p(x,a,b)}
    return $a(x,arguments)}




cV_Cute=function(d,r,n){var w,h;
    if(A(d)){w=d[0];h=d[1]}
    else{if(U(d)){w=2}else{w=d}h=w}
    r=co(r)
    return $( $l("<canvas"+((n)?" id='" +n+ "'":'')+
        ((r)?" style='background-color:"+r+"' ":'')+
        ((w)?" width="+w*100+' ':'')+
        ((h)?" height="+h*100+' ':'')+
        "></canvas>"))[0]}
o.clR=bX("clearRect")
o.vik=function(){return vik(can)}


vik=function(can){
    var x = X(can),
        cx=Xx(can),
        y=sexy(can),
        o= function rc(a,b,c,d){

            if(U(a)){
                rc.C.ap()};
            if(S(a)){
                var s;
                rc.s();

                if(U(b)){s=a}

                else{
                    s="rgba("+_jn([a,b,c,d],",")+")"
                }

                rc.y('f',s);
                rc.X.f(0,0,rc.w(), rc.h());
                rc.r()}

            return rc}return o}




xmm=function(x){
    x=tX(x)
    var f=function f(){
        met('x',x,arguments)
        //f.x[oO('x',b)].apply(f.x,_r(arguments));
        return f}

    f.c=$c(a)
    f.x=xX(f.c)

    return f}



ran500Can=function(){
    var c=tT( em('c',{C:$r()}) )
    return canWH(c, 500)}





xmOld=function(x){
    return function f(){
        met('x',x,arguments)               //f.x[oO('x',b)].apply(f.x,_r(arguments));
        return f}}




cv=basicBlueCanWithCtx=function(a){
    var c=$c()
    ss(c,{C:'b'})
    tT(c)
    c.x=X(c)
    return c}





//$m('x',x,'fr',[0,0,100,100])
xm2=CtxMetfunction(a,b,c){
    var x=met('x', X(a))
    if(U(b)){return _p(x, a)}
    if(U(c)){return _p(x, a, b)}
    return $a(x, arguments)}



xpop=function xp(x,a,b){
    x=X(x)

    if(!a){
        return _p(xp, x)}

    if(O(a)) {
        _e(a,
            function(v,k){
                xp(x,v,k)})
        return x}

    x[oO('X',a)]= oO('fs',b,'R')

    return x}



xp=function l(a,b,c){if(U(b)){return _p(l,a)}
    if(O(b)){pop('X', tX(a),b);return l}
    if(S(b)) return pop('X', tX(a), b,c)}

xm=function(a,b,c){var x=$m('x');a=tX(a)
    if(U(b)){return _p(x,a)}
    if(U(c)){return _p(x,a,b)}
    return $a(x,arguments)}

Cv=function(a){ if( _h(a,"Canvas") ){return $u(a) }



    tD=function(a){a=E(a)
        if(a.toDataURL){ return tDU(a)}
        if(F(a.du)){return a.du()}
        return a}

    pX=function(x){

        x= X(x)

        return function f(a,b){
            var p=oO('X',a)
            if(D(b)){x[p]=b;return f}
            return D(a)? x[p]: x}      }


    mX=function(x){x=X(x)

        return function f(a,b){
            var g=G(arguments)
            x[oO('x',g.f].apply(x,g.r)
            return f}}


    cS=function(n,c,r,w,h){
        n=$l("<canvas"+((n)?" id='" +n+ "'":'')+
            ((c)?" class='"+c+"'":'')+
            ((r)?" style='background-color:"+r+"' ":'')+
            ((w)?" width="+w+' ':'')+
            ((h)?" height="+h+' ':'')+
            "></canvas>");return $(n)[0]}

    Cc=function(v,r,f,n,c){
        if(S(v)){ return can(v) }
        v=$V(v||500);
        return $do(

            cS(n,c,r||'purple',v.x,v.y),
            f)}
    fullC=function(v,r,f,n,c){function gC(a){
        return $w[a]=sC(xE(a))};

        function cS(n,c,r,w,h){
            n=lg("<canvas"+((n)?" id='" +n+ "'":'')+
                ((c)?" class='"+c+"'":'')+
                ((r)?" style='background-color:"+r+"' ":'')+
                ((w)?" width="+w+' ':'')+((h)?" height="+h+' ':'')+
                "></canvas>");
            return $(n)[0]};

        if(S(v)){return gC(v)};
        v=$V(v||[960,450]);
        var s=sC(cS(n,c,r||'yellow',v.x,v.y));
        sr(s,f);
        return s}




    xp=function l(a,b,c){
    if(U(b)){return _p(l,a)}
    if(O(b)){pop('X',a, b); return l}
    if(S(b)){return pop('X', X(a), b,c)}}


xSet=function s(a, b,c){
    a=X(a)
    if(!b){return _p(s,a)}
    if(O(b)){ _e(b,function(v,k){ s(a,k,v) })}
    a[oO('X',b) ]=oO(b,c,'R')
    return a}





xs1=function(c,v,k){var x=X(c)
    return s1('X',x,v,k)}
xs0=function(c){return _p(xs1, c)}
xm=function(a,b,c){
    var x=$m('x',X(a))
    return x}
//return $a(x,arguments)


X=function c(a){
    if(a.canvas){return a}
    var e=$(a)[0]
    if (e['getContext'])
        return e.getContext('2d')}





xx = function(a){  //$x reserved in console for xpath
    var f=function(b){
        if(U(b)){return f.x}
        f.x[ Oo('x',b) ].apply(f.x, _r(arguments))
        return f}
    f.c=(E(a))?a:((Q(a)))?a[0]:(O(a))?a:$c.apply(this,arguments)
    f.x=xX( f.c )
    return f}



xp=pop('X')  ///oO(  jo(b, oO('R')  )
xm=function(a){

    var f=function(b){if(U(b)){return f.x}
        f.x[ Oo( 'x', b ) ].apply( f.x, _r( arguments ) )
        return f}

    f.c =(E(a))? a: ((Q(a)))?  a[0]:
        (O(a))? a: $c.apply(f,arguments)

    f.x =xX(f.c); return f}



// a brilliant function that you pass a canvas  to; it returns a fn that lets u make calls on the ctx by using the abbreviated obj keys

var Cv=function(c){
    var x=c.getContext('2d'),
        o={obj:c},  w="width",h="height" ,sv="save",rs="restore",
        rt="rotate",  sc="scale",  tl="translate",
        sk="skew",clR="clearRect", pt="createPattern",rg="createRadialGradient",
        lg="createLinearGradient",cs="addColorStop",
        bp="beginPath",cp="closePath", du="toDataURL",
        cl="clip",re="rect",mt="moveTo", fl="fill",fr="fillRect",
        ft="fillText", so="stroke",sr="strokeRect",  st="strokeText",
        lt="lineTo",at="arcTo",  gid="getImageData", pid="putImageData",
        fo="font", pp="isPointInPath",di="drawImage "}
//c.S=sS(S$(C),c);
//  c.C=sEl(C);
//  c.X=sX(C.getContext('2d'),c);
//h.$=sQ($(h));//c.H = _.b(c.C.H, c.C); c.pop=c.X_=_.b(c.X.pop,c.X);// o.q=Fransi($(h));o.ctx=x;
// a brilliant function that you pass a canvas  to;
// it returns a fn that lets u make calls on the ctx
// by using the abbreviated obj keys
/// below:  x, CANVAS
xx=function(c){ var x= Xx(c),

    XXX={a:"arc",at:"arcTo",z:"bezierCurveTo",
        b:"beginPath",c:"closePath",cr:"clearRect",
        j:"clip",d:"drawImage",f:"fill",fr:"fillRect",ft:"fillText",
        g:"createLinearGradient",gi:"getImageData",i:"createImageData",
        ip:"isPointInPath",is:"isPointInStroke",v:"save",
        l:"lineTo",m:"moveTo",mt:"measureText",pi:"putImageData",
        p:"createPattern",q:"quadraticCurveTo",rg:"createRadialGradient",
        rc:"rect",r:"restore",S:"scale", T:"translate" , R:"rotate",
        s:"stroke",sr:"strokeRect",st:"strokeText",
        t:"transform",tf:"setTransform"}
    return function(m){
        return x[XXX[m]].apply(x, rest(arguments))}}




xp=function l(a,b,c){
    if(U(b)){return _p(l,a)}

    if(O(b)){
        pop('X', a, b);
        return l}

    if(S(b)) {return pop('X', X(a), b,c)}}
xm2=function(a,b,c){
    var x=met('x', X(a))
    if(U(b)){return _p(x, a)}
    if(U(c)){return _p(x, a,b)}
    return $a(x, arguments)}
xm=function(a,b,c){
    var x=met('x', X(a))
    return x
    //return $a(x,arguments)
}
xSet=function s(a, b, c){
    if(!b){return _p(s,a)}
    if(O(b)){ _e(b,function(v,k){ s(a,k,v) })}
    a[ oO('X',b) ]= oO(b,c ,'R')
    return a}
ox=function(c){
    //if(F(c)){return c}

    var l=function l(a,b){
        var g=G(arguments)
        if(A(a)){return l.p(a[0]) }
        if(O(a)){l.p(a);
            if(!b){return l.x}
            return $a(l.m,_r(g))}
        if(O(a)){l.p(a); return l}
        return $a(l.m,g)||l}

    l.x=X(c);
    l.c=x.canvas;
    l.q=$(l.c)
    l.m=xm(l.x)
    l.p=xp(l.x)
    l.w=l.c.width
    l.h=l.c.height

    return l}
xx=function(c){var x

    //if(F(c)){return c}
    if (!(x = X(c))  ) {return}

    var l=function l(a,b){var g=G(arguments)

        if(A(a)){return l.p( a[0] )}

        if(O(a)){
            l.p(a);
            if(!b){return l.x}
            return _a(l.m, _r(g))}

        if(O(a)){l.p(a);return l}

        return $a(l.m, g)|| l}

    l.x=x
    l.c=l.x.canvas
    l.q=$(l.c)
    l.m=xm(l.x)
    l.p=xpop(l.x)
    l.w=l.c.width
    l.h=l.c.height
    return l}
xpop=function xp(x,a,b){
    x=X(x)

    if(!a){
        return _p(xp, x)}

    if(O(a)) {
        _e(a,
            function(v,k){
                xp(x,v,k)})
        return x}

    x[oO('X',a)]= oO('fs',b,'R')

    return x}




sexy=function(c){
    var x=Xx(c), q=$(c), cx = xx(x), o=function(){};
    o.du=function(){return c.toDataURL()};o.img= o.jj=o.du();
    o.save= o.s= o.i=function(){x.save();return o};
    o.restore=o.r= o.I=function(){x.restore();return o};
    o.copy=o.j=function(){o.I=O.jj=o.du();return o};
    o.paste=function(){o.X();o.d(o.jj)}
    o.replace=function(){o.X();o.d(o.jj)}
    o.pasteFit=o.p= o.J=function(){o.fit(o.img,0,0)}
    o.w=function(w){if(!w){return c.width} var u=o.du(); c.width=w; if(!z){o.fit(u)} return o}
    o.h=function(h){if(!h){return c.height} var u=o.du(); c.height=h; if(!z){o.fit(u)} return o}
    o.wh=function(w,h){var u;
        if(!w){return $V(o.w(),o.h())};
        u=o.du();
        o.w(w);
        o.h(h||w);
        o.fit(u);
        return o};
    c.x=function(x){if(!x){return q.offset().left}; return parseInt(x-o.x())}
    c.y=function(y){if(!y){return q.offset().top}; return parseInt(y-o.y())}
    o.H=o.html=o.e=function(){return o.outerHTML}
    o.css=o.l=function(){q.css.apply(q,arguments);return o}
    o.clR=function(){x.clear();return o}
    o.clear=o.X=function(){x.clearRect(0,0,o.w(),o.h());return o};
    o.color=function f(a,b,c,d){
        if(U(a)){f.c.ap()};
        if(S(a)){var s;
            o.s();
            if(U(b)){s=a}
            else{s="rgba("+ [a,b,c,d].join(",") +")"}
            o.pop('f', s);
            o.f(0,0,o.w(),o.h());
            o.r()}
        return f}
    o.bgCol=o.k=function(a){return o.l('backgroundColor',a)};
    border=function(s,c,y){if(U(S)){s=10};
        var ws=function(a){return ' '+a+' '};
        o.l('border',$l(ws(s+"px")+ws(y||"solid")+ws(c||"blue")));
        return o}
    o.ap=function(){$("body").append(q);return o}
    o.pp= o.bod=function(){$("body").prepend(q);return o}
    o.puzzle=function(a,b){return o[pp](a,b)}
    CTX={a:'globalAlpha', b:'shadowBlur',
        r:'shadowColor', x:'shadowOffsetX',
        y:'shadowOffsetY' ,
        c:'lineCap',  m:'miterLimit',j:'lineJoin',
        w:'lineWidth' ,
        f:'fillStyle', s:'strokeStyle',
        t:'font',g:'textAlign',e:'textBaseline',
        o:'globalCompositeOperation'}
    o.pop=function(a,b){
        if(!b){return o[CTX[a]]}
        o[CTX[a]]=b;
        return o}
    o.mystery=function(a,b,c,d){
        if(U(a)){o.x(0,0,o.w(),o.h())return o}
        if(N(a)){o.x(a,b||a,c||200,d||c)}}
    o.U=function(){s.u;return o}
    o.gradient=function(a,b,c,d,e,f){var  G=arguments,
        pt={x:"repeat-x",y:"repeat-y",z:"no-repeat"};

        if(!N(a)){return cx('p',a,pt[b]||null)};
        if(f){g=cx('rg', G)}
        else if(d){
            g=cx('rg',G)
            return g.addColorStop(a, b)}
    }
    gco={d:'destination-over',da:'destination-atop',
        do:'destination-out',
        di:'destination-in',
        s:'source-over',a:'source-atop',o:'source-out', i:'source-in',
        l:'lighter', x:'xor',c:'copy'}
    o.gc=function(a){x.globalCompositeOperation=gco[a]}
    o.gco=function(a){return o.pop('o',gco[a])}
    o.shad=function(a,b){
        if(S(a)){
            return o.pop('r',a).pop('b',b||0)}
        return o.pop('x',a).pop('y',b||a)}
    o.font=function(a){var ;
        if(U(a)){return x.font}
        x.font=a;return o};
    o.font("100px Georgia");
    o.pat= o.grad=o.g=function(a,b,c,d,e,f){var g;
        if(!N(a)){return o[pt](a, PT[b]||null)};
        if(f){g=x[rg](a,b,c,d,e,f)}
        else if(d){g=x[lg](a,b,c,d)};
        return g[cs](a,b)}
    o.pBl=function(n){o.tBl(function(b){svAs(b,n+".png")});return o}
    o.bp=function(n){this.toBlob(function(b){saveAs(b,n+".png")});return o}
    o.tBlob=o.bl=function(){c.toBlob(function(b){sv(b)});return o}
    o.fitRect= o.r=function(n1,n2,n3,n4){
        if(!n2){s=n1} else {s="rgba("+n1+","+n2+","+n3+","+n4+")"};
        o.c.save();
        o.c.fillStyle=s;
        o.c.fillRect(0,0,o.w(),o.h());
        o.c.restore()};
    o.$=function(a){
        q.click(function(e){
            var x=e.clientX,y=e.clientY;
            a(x-c.x(),y-c.y(),x,y)});
        return o}
    o.$$=function(a){
        q.dblclick(function(e){
            var x=e.clientX, y=e.clientY;
            a(x-c.x(),y-c.y(),x,y)})
        return o}


}

